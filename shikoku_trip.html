<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>å››åœ‹5å¤©4å¤œ (ç©©å®šç‰ˆ)</title>
<style>
    /* åŸºç¤è¨­å®š */
    body {
        font-family: -apple-system, sans-serif; background: #F2F2F2; color: #333;
        margin: 0; padding: 0; padding-bottom: 100px; -webkit-tap-highlight-color: transparent;
    }
    
    /* é ‚éƒ¨è³‡è¨Š */
    .header {
        background: #FFF; padding: 12px; text-align: center; position: sticky; top: 0; z-index: 100;
        border-bottom: 1px solid #DDD; box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    h1 { margin: 5px 0; font-size: 1.2rem; }
    .rates { font-size: 0.85rem; color: #666; background: #EEE; padding: 4px 10px; border-radius: 15px; display: inline-block; }

    /* åˆ‡æ›æŒ‰éˆ• */
    .nav { display: flex; padding: 10px; gap: 10px; background: #FFF; border-bottom: 1px solid #EEE; }
    .nav-btn {
        flex: 1; padding: 10px; border: 1px solid #DDD; background: #F8F8F8;
        border-radius: 6px; font-weight: bold; color: #666; font-size: 1rem;
    }
    .nav-btn.active { background: #C5B396; color: #FFF; border-color: #C5B396; }

    /* é é¢å®¹å™¨ */
    .page { display: none; padding: 10px; }
    .page.active { display: block; }

    /* è¡Œç¨‹å¡ç‰‡ */
    .card { background: #FFF; border-radius: 8px; margin-bottom: 15px; overflow: hidden; border: 1px solid #E0E0E0; }
    .card-head {
        padding: 12px 15px; background: #EFEFEF; border-bottom: 1px solid #DDD;
        display: flex; justify-content: space-between; align-items: center;
    }
    .weather { font-size: 0.8rem; color: #555; text-decoration: none; border: 1px solid #AAA; padding: 2px 6px; border-radius: 4px; background: #FFF; }

    /* è¡Œç¨‹åˆ—è¡¨ */
    .list { padding: 5px 15px 15px 15px; display: none; }
    .item { padding: 15px 0; border-bottom: 1px solid #EEE; }
    .item:last-child { border: none; }
    
    .time { background: #C5B396; color: #FFF; padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; font-weight: bold; }
    .name { font-size: 1.05rem; font-weight: bold; margin: 6px 0; color: #222; }
    .desc { color: #666; font-size: 0.9rem; margin-bottom: 8px; line-height: 1.4; }

    /* äº¤é€šè³‡è¨Šæ¡† */
    .trans {
        background: #F0F8FF; border: 1px solid #BCDFF1; border-left: 4px solid #4A90E2;
        padding: 8px; border-radius: 4px; font-size: 0.85rem; margin-bottom: 8px;
    }
    .row { display: flex; margin-bottom: 3px; }
    .lbl { font-weight: bold; min-width: 45px; color: #333; }
    .tag { color: #FFF; padding: 1px 4px; border-radius: 3px; font-size: 0.75rem; margin-left: 5px; }
    .tag-r { background: #E74C3C; } /* ç´…è‰²è­¦ç¤º */
    .tag-g { background: #2ECC71; } /* ç¶ è‰²å®‰å…¨ */
    .tag-o { background: #F39C12; } /* æ©˜è‰²æ™®é€š */

    /* æŒ‰éˆ•ç¾¤ */
    .btns { display: flex; gap: 8px; margin-top: 8px; }
    .btn {
        flex: 1; padding: 8px 0; text-align: center; border-radius: 4px;
        text-decoration: none; font-size: 0.9rem; font-weight: bold;
        border: 1px solid #CCC; background: #FFF; color: #444; cursor: pointer;
    }
    .btn-go { background: #4A90E2; color: #FFF; border: none; }
    .btn-wk { background: #2ECC71; color: #FFF; border: none; }
    .btn-full { width: 100%; margin-top: 8px; background: #F5A623; color: #FFF; border: none; }

    /* å½ˆçª— */
    .modal-bg {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.5); align-items: center; justify-content: center; z-index: 999;
    }
    .modal-box {
        background: #FFF; width: 85%; max-width: 320px; padding: 20px;
        border-radius: 10px; max-height: 80vh; overflow-y: auto;
    }

    /* è¨˜å¸³ */
    .sum-box { background: #FFF; padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 15px; border: 1px solid #DDD; }
    .input-box { background: #FFF; padding: 15px; border-radius: 8px; border: 1px solid #DDD; }
    .in-row { display: flex; gap: 5px; margin-bottom: 10px; }
    .inp { flex: 1; padding: 8px; border: 1px solid #CCC; border-radius: 4px; font-size: 1rem; }
    .hist-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #EEE; align-items: center; }
</style>
</head>
<body>

<div class="header">
    <h1>å››åœ‹5å¤©4å¤œ</h1>
    <span class="rates">1 JPY â‰ˆ 0.051 HKD / 0.215 TWD</span>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="pg('trip',this)">ğŸ“… è¡Œç¨‹</button>
    <button class="nav-btn" onclick="pg('money',this)">ğŸ’° è¨˜å¸³</button>
</div>

<div id="trip" class="page active"></div>

<div id="money" class="page">
    <div class="sum-box">
        <div style="color:#888; font-size:0.9rem">ç¸½æ”¯å‡º</div>
        <div style="font-size:2rem; font-weight:bold" id="t-jpy">Â¥0</div>
        <div style="color:#999; font-size:0.85rem" id="t-for">HK$0 / NT$0</div>
    </div>
    
    <div class="input-box">
        <div class="in-row">
            <select id="dt" class="inp" style="flex:1"><option>1/5</option><option>1/6</option><option>1/7</option><option>1/8</option><option>1/9</option></select>
            <input id="nm" class="inp" placeholder="é …ç›®" style="flex:2">
        </div>
        <input id="am" type="number" class="inp" placeholder="é‡‘é¡ (æ—¥å¹£)" style="width:100%; box-sizing:border-box; margin-bottom:10px">
        <button onclick="add()" class="btn btn-go" style="width:100%">ï¼‹ åŠ å…¥è¨˜å¸³</button>
    </div>
    <div id="hist" class="input-box" style="margin-top:15px; border:none; background:none; padding:0;"></div>
</div>

<div id="mod" class="modal-bg" onclick="cl(event)">
    <div class="modal-box">
        <h3 id="mt" style="margin-top:0; border-bottom:1px solid #EEE; padding-bottom:10px;"></h3>
        <div id="mc" style="line-height:1.5; font-size:0.95rem; color:#444;"></div>
        <button onclick="document.getElementById('mod').style.display='none'" class="btn" style="width:100%; margin-top:15px; background:#EEE">é—œé–‰</button>
    </div>
</div>

<script>
// --- è³‡æ–™åº« ---
const D = [
 {
  d: "1/5 (ä¸€)", t: "æŠµé”é«˜æ¾", w: "â˜ï¸ æ°£è±¡", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=370000",
  i: [
   {tm:"11:10", n:"æ©Ÿå ´å·´å£« â†’ å…µåº«ç”º", d:"ç›´é”å¸‚å€ã€‚", 
    tr:{l:"æ©Ÿå ´2è™Ÿä¹˜è»Šè™•", f:"é£›æ©Ÿåˆ°å°±æœ‰è»Š", c:"tag-o", t:"é…åˆèˆªç­"},
    o:"Takamatsu Airport", z:"Hyogomachi Bus Stop", m:"transit",
    tip:{t:"ğŸšŒ å·´å£«æ”»ç•¥", c:"ä¸ç”¨é ç´„ï¼Œå‡ºé—œå·¦æ‰‹é‚Šè²·ç¥¨ï¼Œç´„Â¥1000ã€‚"}
   },
   {tm:"12:30", n:"ã†ã©ã‚“å¸‚å ´", d:"çƒé¾éºµååº—ã€‚", map:"Udon Ichiba Hyogo-machi"}
  ]
 },
 {
  d: "1/6 (äºŒ)", t: "é‡‘åˆ€æ¯”ç¾…å®®", w: "â˜€ï¸ æ°£è±¡", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=370000",
  i: [
   {tm:"09:00", n:"ç´é›»å‰å¾€ç´å¹³", d:"é»ƒè‰²é›»è»Šã€‚", 
    tr:{l:"é«˜æ¾ç¯‰æ¸¯ç«™", f:"15-30åˆ†/ç­", c:"tag-g", t:"ç­æ¬¡å¯†"},
    o:"Takamatsu-Chikko Station", z:"Kotoden-Kotohira Station", m:"transit",
    tip:{t:"ğŸš‹ ç´é›»æ”»ç•¥", c:"å…åŠƒä½ï¼Œç›´æ¥åˆ· IC å¡é€²ç«™ã€‚"}
   },
   {tm:"10:00", n:"é‡‘åˆ€æ¯”ç¾…å®®", d:"çˆ¬éšæ¢¯ã€‚", map:"Kotohira-gu"},
   {tm:"20:00", n:"å›ç¨‹ï¼šæ­¥è¡Œå›é£¯åº—", d:"åƒé£½æ•£æ­¥ã€‚", o:"Ikkaku Takamatsu", z:"Toyoko Inn Takamatsu Hyogomachi", m:"walking"}
  ]
 },
 {
  d: "1/7 (ä¸‰)", t: "ç§»å‹•è‡³æ¾å±±", w: "ğŸŒ¥ï¸ æ°£è±¡", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=380000",
  i: [
   {tm:"09:00", n:"JR ç‰¹æ€¥ Ishizuchi", d:"å¾€æ¾å±± (2.5hr)ã€‚", 
    tr:{l:"JRé«˜æ¾ç«™", f:"1å°æ™‚/ç­", c:"tag-r", t:"ç­æ¬¡å°‘"},
    o:"Takamatsu Station", z:"Matsuyama Station", m:"transit",
    tip:{t:"ğŸš„ JR è³¼ç¥¨", c:"å»ºè­° Day 1 å°±å…ˆè²·å¥½ã€ŒæŒ‡å®šå¸­ã€è»Šç¥¨ã€‚"}
   },
   {tm:"13:30", n:"é“å¾Œæº«æ³‰", d:"é€›è¡—+æ³¡æ¹¯ã€‚", map:"Dogo Haikara Dori"},
   {tm:"17:30", n:"å›ç¨‹ï¼šè·¯é¢é›»è»Š", d:"å›é£¯åº—ã€‚", 
    tr:{l:"é“å¾Œæº«æ³‰ç«™", f:"10åˆ†/ç­", c:"tag-g", t:"ç­æ¬¡å¯†"},
    o:"Dogo Onsen Station", z:"Katsuyamacho Station", m:"transit",
    tip:{t:"ğŸšƒ é›»è»Šæ”»ç•¥", c:"ä¸èƒ½ç”¨ IC å¡ï¼Œè«‹æŠ•å¹£ Â¥180ã€‚"}
   }
  ]
 },
 {
  d: "1/8 (å››)", t: "æ¾å±±åŸ", w: "â˜€ï¸ æ°£è±¡", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=380000",
  i: [
   {tm:"10:30", n:"æ¾å±±åŸ", d:"çºœè»Š+å¤©å®ˆé–£ã€‚", map:"Matsuyama Castle Ropeway Station"},
   {tm:"16:00", n:"å›ç¨‹ï¼šæ­¥è¡Œå›é£¯åº—", d:"æ•´ç†è¡Œæã€‚", o:"Okaido Shopping Street", z:"Toyoko Inn Matsuyama Ichibancho", m:"walking"}
  ]
 },
 {
  d: "1/9 (äº”)", t: "è¿”ç¨‹ (å²¡å±±å›)", w: "â˜ï¸ æ°£è±¡", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=330000",
  i: [
   {tm:"11:00", n:"JR ç‰¹æ€¥ Shiokaze", d:"å¾€å²¡å±± (3hr)ã€‚", 
    tr:{l:"JRæ¾å±±ç«™", f:"1å°æ™‚/ç­", c:"tag-r", t:"éŒ¯éè¶•ä¸ä¸Šé£›æ©Ÿ"},
    o:"Matsuyama Station", z:"Okayama Station", m:"transit",
    tip:{t:"âš ï¸ å›ç¨‹ JR æ³¨æ„", c:"ä¸€å®šè¦ææ—©è²·ç¥¨ï¼æ¨è–¦æ­ 11:25 çš„è»Šã€‚"}
   },
   {tm:"15:10", n:"å²¡å±±æ©Ÿå ´å·´å£«", d:"å¾€æ©Ÿå ´ã€‚", 
    tr:{l:"å²¡å±±è¥¿å£21è™Ÿ", f:"é…åˆèˆªç­", c:"tag-o", t:"å›ºå®šç­æ¬¡"},
    o:"Okayama Station", z:"Okayama Airport", m:"transit",
    tip:{t:"ğŸšŒ å·´å£«æ”»ç•¥", c:"è¥¿å£ 21 è™Ÿæœˆå°ï¼Œæ—é‚Šæœ‰å”®ç¥¨æ©Ÿã€‚"}
   },
   {tm:"17:55", n:"IT263 é£›é«˜é›„", d:"è™èˆªã€‚", map:"Okayama Airport"}
  ]
 }
];

// --- æ¸²æŸ“ ---
function render() {
 let h = "";
 D.forEach((d, i) => {
  let list = "";
  d.i.forEach((x, xi) => {
   // äº¤é€šæ¡†
   let tr = "";
   if(x.tr) tr = `<div class="trans"><div class="row"><div class="lbl">ğŸ“</div><div>${x.tr.l}</div></div><div class="row"><div class="lbl">â°</div><div>${x.tr.f} <span class="tag ${x.tr.c}">${x.tr.t}</span></div></div></div>`;
   
   // æŒ‰éˆ•
   let b = "";
   if(x.tip) b += `<button class="btn btn-full" onclick="pop(${i},${xi})">ğŸ« è³¼ç¥¨æ”»ç•¥</button>`;
   
   if(x.o && x.z) {
     // ä½¿ç”¨æ¨™æº– Google Maps é€£çµï¼Œé˜²æ­¢ç•¶æ©Ÿ
     let url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(x.o)}&destination=${encodeURIComponent(x.z)}&travelmode=${x.m}`;
     b += `<div class="btns"><a href="${url}" target="_blank" class="btn ${x.m=='walking'?'btn-wk':'btn-go'}">${x.m=='walking'?'ğŸš¶ æ­¥è¡Œå°èˆª':'ğŸšŒ æŸ¥è·¯ç·š'}</a></div>`;
   } else if(x.map) {
     let url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(x.map)}`;
     b += `<div class="btns"><a href="${url}" target="_blank" class="btn">ğŸ“ åœ°åœ–</a></div>`;
   }

   list += `<div class="item"><span class="time">${x.tm}</span><div class="name">${x.n}</div>${tr}<div class="desc">${x.d}</div>${b}</div>`;
  });
  
  let disp = i === 0 ? "block" : "none";
  h += `<div class="card"><div class="card-head" onclick="tog(this)"><div><b>${i+1}</b> ${d.t}</div><a href="${d.wl}" target="_blank" class="weather">${d.w}</a></div><div class="list" style="display:${disp}">${list}</div></div>`;
 });
 document.getElementById("trip").innerHTML = h;
 loadM();
}

// --- åŠŸèƒ½ ---
function pg(id, el) {
 document.querySelectorAll(".page").forEach(x => x.style.display = "none");
 document.querySelectorAll(".nav-btn").forEach(x => x.classList.remove("active"));
 document.getElementById(id).style.display = "block";
 el.classList.add("active");
}

function tog(el) {
 let s = el.nextElementSibling.style;
 s.display = s.display === "block" ? "none" : "block";
}

function pop(di, xi) {
 let t = D[di].i[xi].tip;
 document.getElementById("mt").innerText = t.t;
 document.getElementById("mc").innerHTML = t.c;
 document.getElementById("mod").style.display = "flex";
}
function cl(e) { if(e.target.id == "mod") e.target.style.display = "none"; }

// --- è¨˜å¸³ ---
let M = [];
function loadM() {
 try { M = JSON.parse(localStorage.getItem("m_fix")) || []; } catch { M = []; }
 drawM();
}
function drawM() {
 let h = "", t = 0;
 M.slice().reverse().forEach(x => {
  t += parseInt(x.a);
  h += `<div class="hist-item"><div><b>${x.n}</b> <small style="color:#999">(${x.d})</small></div><div>Â¥${x.a} <button onclick="del(${x.id})" style="border:none;background:none;color:#CCC;font-size:1.2rem;padding:0 10px">Ã—</button></div></div>`;
 });
 document.getElementById("hist").innerHTML = h;
 document.getElementById("t-jpy").innerText = "Â¥" + t;
 document.getElementById("t-for").innerText = `HK$${Math.round(t * 0.051)} / NT$${Math.round(t * 0.215)}`;
}
function add() {
 let d = document.getElementById("dt").value, n = document.getElementById("nm").value, a = document.getElementById("am").value;
 if(!n || !a) return;
 M.push({ id: Date.now(), d: d, n: n, a: a });
 localStorage.setItem("m_fix", JSON.stringify(M));
 document.getElementById("nm").value = ""; document.getElementById("am").value = "";
 drawM();
}
function del(id) {
 if(confirm("åˆªé™¤ï¼Ÿ")) { M = M.filter(x => x.id != id); localStorage.setItem("m_fix", JSON.stringify(M)); drawM(); }
}

render();
</script>
</body>
</html> 