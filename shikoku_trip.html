<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>å››åœ‹5å¤©4å¤œ (æœ€çµ‚ç¢ºèªç‰ˆ)</title>
<style>
    /* åŸºç¤è¨­å®š */
    body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; 
        background: #F5F5F7; color: #1D1D1F;
        margin: 0; padding: 0; padding-bottom: 100px; -webkit-tap-highlight-color: transparent;
    }
    
    /* é ‚éƒ¨è³‡è¨Š */
    .header {
        background: rgba(255, 255, 255, 0.95); padding: 15px; text-align: center; position: sticky; top: 0; z-index: 100;
        border-bottom: 1px solid #E5E5E5; backdrop-filter: blur(10px);
    }
    h1 { margin: 5px 0; font-size: 1.3rem; font-weight: 700; letter-spacing: -0.5px; }
    .sub-info { font-size: 0.8rem; color: #86868B; margin-top: 5px; }

    /* åˆ‡æ›æŒ‰éˆ• */
    .nav { display: flex; padding: 10px 15px; gap: 10px; background: #FFF; border-bottom: 1px solid #E5E5E5; }
    .nav-btn {
        flex: 1; padding: 8px; border: none; background: #F2F2F7;
        border-radius: 8px; font-weight: 600; color: #86868B; font-size: 0.95rem; transition: all 0.2s;
    }
    .nav-btn.active { background: #007AFF; color: #FFF; box-shadow: 0 2px 5px rgba(0,122,255,0.2); }

    /* é é¢å®¹å™¨ */
    .page { display: none; padding: 15px; max-width: 600px; margin: 0 auto; }
    .page.active { display: block; animation: fadeIn 0.3s ease; }

    /* è¡Œç¨‹å¡ç‰‡ */
    .card { background: #FFF; border-radius: 12px; margin-bottom: 20px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.03); border: 1px solid #F0F0F0; }
    .card-head {
        padding: 15px; background: #FFF; border-bottom: 1px solid #F5F5F5;
        display: flex; justify-content: space-between; align-items: center; cursor: pointer;
    }
    .date-badge { background: #000; color: #FFF; padding: 2px 8px; border-radius: 6px; font-size: 0.85rem; font-weight: bold; margin-right: 8px; }
    .weather { font-size: 0.8rem; color: #007AFF; text-decoration: none; background: #E5F1FF; padding: 4px 8px; border-radius: 12px; font-weight: 600; }

    /* è¡Œç¨‹åˆ—è¡¨ */
    .list { padding: 5px 20px 20px 20px; display: none; }
    .item { padding: 20px 0; border-bottom: 1px solid #F0F0F0; position: relative; }
    .item:last-child { border: none; }
    
    /* æ™‚é–“è»¸ç·šæ¢ */
    .item::before {
        content: ''; position: absolute; left: 6px; top: 45px; bottom: -15px;
        width: 2px; background: #E5E5E5; z-index: 0;
    }
    .item:last-child::before { display: none; }

    .time { 
        background: #F5F5F7; color: #1D1D1F; padding: 4px 8px; border-radius: 6px; 
        font-size: 0.85rem; font-weight: 700; display: inline-block; position: relative; z-index: 1;
    }
    .name { font-size: 1.1rem; font-weight: 700; margin: 8px 0 4px 0; color: #1D1D1F; }
    .desc { color: #6E6E73; font-size: 0.95rem; margin-bottom: 10px; line-height: 1.5; }

    /* äº¤é€šè³‡è¨Šæ¡† */
    .trans {
        background: #F5F9FF; border-radius: 8px; padding: 10px; 
        font-size: 0.9rem; margin: 10px 0; border-left: 4px solid #007AFF;
    }
    .trans-row { display: flex; align-items: flex-start; margin-bottom: 4px; }
    .trans-icon { min-width: 20px; margin-right: 5px; }
    .tag { display: inline-block; padding: 2px 6px; border-radius: 4px; font-size: 0.75rem; font-weight: bold; color: #FFF; margin-left: 5px; }
    .tag-r { background: #FF3B30; } /* ç´…è‰²è­¦ç¤º */
    .tag-g { background: #34C759; } /* ç¶ è‰²å®‰å…¨ */
    .tag-o { background: #FF9500; } /* æ©˜è‰²æ™®é€š */

    /* æŒ‰éˆ•ç¾¤ */
    .btns { display: flex; gap: 10px; margin-top: 12px; }
    .btn {
        flex: 1; padding: 10px 0; text-align: center; border-radius: 8px;
        text-decoration: none; font-size: 0.9rem; font-weight: 600;
        cursor: pointer; transition: opacity 0.2s; border: none;
    }
    .btn:active { opacity: 0.7; }
    .btn-map { background: #E5F1FF; color: #007AFF; }
    .btn-tip { background: #FFF0E5; color: #FF9500; width: 100%; margin-top: 10px; }

    /* å½ˆçª— */
    .modal-bg {
        display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.6); align-items: center; justify-content: center; z-index: 999; backdrop-filter: blur(2px);
    }
    .modal-box {
        background: #FFF; width: 85%; max-width: 320px; padding: 25px;
        border-radius: 16px; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .modal-title { font-size: 1.2rem; font-weight: bold; margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #EEE; }

    /* è¨˜å¸³ */
    .sum-box { background: #333; color: #FFF; padding: 20px; border-radius: 12px; text-align: center; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
    .input-group { background: #FFF; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
    .inp { width: 100%; padding: 10px; border: 1px solid #E5E5E5; border-radius: 8px; font-size: 1rem; margin-bottom: 10px; box-sizing: border-box; background: #F9F9F9; }
    .btn-add { background: #000; color: #FFF; width: 100%; padding: 12px; border-radius: 8px; font-weight: bold; border: none; font-size: 1rem; }
    .hist-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #F0F0F0; align-items: center; }

    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>

<div class="header">
    <h1>å››åœ‹ 5 å¤© 4 å¤œ</h1>
    <div class="sub-info">é«˜æ¾é€²ï¼å²¡å±±å‡º (1/5 - 1/9)</div>
</div>

<div class="nav">
    <button class="nav-btn active" onclick="pg('trip',this)">ğŸ“… è¡Œç¨‹è¡¨</button>
    <button class="nav-btn" onclick="pg('money',this)">ğŸ’° è¨˜å¸³æœ¬</button>
</div>

<div id="trip" class="page active"></div>

<div id="money" class="page">
    <div class="sum-box">
        <div style="font-size:0.9rem; opacity:0.8; margin-bottom:5px;">ç¸½æ”¯å‡º (JPY)</div>
        <div style="font-size:2.5rem; font-weight:bold" id="t-jpy">Â¥0</div>
        <div style="font-size:0.9rem; opacity:0.8; margin-top:5px;" id="t-for">HK$0 / NT$0</div>
    </div>
    
    <div class="input-group">
        <div style="display:flex; gap:10px; margin-bottom:10px;">
            <select id="dt" class="inp" style="flex:1">
                <option>1/5 (ä¸€)</option><option>1/6 (äºŒ)</option><option>1/7 (ä¸‰)</option>
                <option>1/8 (å››)</option><option>1/9 (äº”)</option>
            </select>
            <input id="nm" class="inp" placeholder="é …ç›® (å¦‚: æ™šé¤)" style="flex:2; margin-bottom:0;">
        </div>
        <input id="am" type="number" class="inp" placeholder="é‡‘é¡ (æ—¥å¹£)" style="margin-bottom:15px">
        <button onclick="add()" class="btn-add">ï¼‹ åŠ å…¥é€™ç­†æ¶ˆè²»</button>
    </div>
    
    <div id="hist" style="margin-top:20px; background:#FFF; padding:0 20px; border-radius:12px; box-shadow:0 2px 8px rgba(0,0,0,0.05);"></div>
</div>

<div id="mod" class="modal-bg" onclick="cl(event)">
    <div class="modal-box">
        <div id="mt" class="modal-title"></div>
        <div id="mc" style="line-height:1.6; font-size:0.95rem; color:#444;"></div>
        <button onclick="document.getElementById('mod').style.display='none'" class="btn" style="width:100%; margin-top:20px; background:#F2F2F7; color:#000;">é—œé–‰</button>
    </div>
</div>

<script>
// --- è¡Œç¨‹è³‡æ–™åº« (Updated 2025) ---
const D = [
 {
  d: "1/5 (ä¸€)", t: "é«˜æ¾æŠµé”ï¼çƒé¾éºµ", w: "â˜ï¸ å¤šé›²æ™‚æ™´", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=370000",
  i: [
   {tm:"10:20", n:"æŠµé”é«˜æ¾æ©Ÿå ´ (TAK)", d:"å‡ºé—œå¾Œå‰å¾€2è™Ÿä¹˜è»Šè™•ã€‚", 
    tr:{l:"æ©Ÿå ´å·´å£« â†’ å…µåº«ç”º", f:"é…åˆèˆªç­ç™¼è»Š", c:"tag-o", t:"å…é ç´„"},
    o:"Takamatsu Airport", z:"Hyogomachi", m:"transit",
    tip:{t:"ğŸšŒ æ©Ÿå ´å·´å£«æ”»ç•¥", c:"1. å‡ºé—œå¾Œå·¦æ‰‹é‚Šæ‰¾è‡ªå‹•å”®ç¥¨æ©Ÿã€‚<br>2. è³¼è²·å¾€ã€Œé«˜æ¾é§…ã€æ–¹å‘è»Šç¥¨ (ç´„Â¥1,000)ã€‚<br>3. åœ¨ã€Œå…µåº«ç”ºã€æˆ–ã€Œé«˜æ¾é§…ã€ä¸‹è»Š (è¦–é£¯åº—è€Œå®š)ã€‚"}
   },
   {tm:"12:30", n:"åˆé¤ï¼šã†ã©ã‚“å¸‚å ´", d:"è®šå²çƒé¾éºµåˆé«”é©— (å…µåº«ç”ºå•†åº—è¡—å…§)ã€‚", map:"Udon Ichiba Hyogo-machi"},
   {tm:"14:00", n:"é«˜æ¾å¸‚å€æ•£ç­–", d:"é€›å…¨æ—¥æœ¬æœ€é•·å•†åº—è¡—ã€é«˜æ¾æ¸¯èµ¤ç‡ˆå°ã€‚", map:"Takamatsu Marugamemachi Shopping Street"},
   {tm:"18:30", n:"æ™šé¤ï¼šä¸€é¶´ (éª¨ä»˜é³¥)", d:"å¿…åƒå¸¶éª¨çƒ¤é›è…¿ã€‚", map:"Ikkaku Takamatsu"},
   {tm:"20:00", n:"å…¥ä½ï¼šæ±æ©«INN é«˜æ¾å…µåº«ç”º", d:"æ—©é»ä¼‘æ¯ã€‚", map:"Toyoko Inn Takamatsu Hyogomachi"}
  ]
 },
 {
  d: "1/6 (äºŒ)", t: "é‡‘åˆ€æ¯”ç¾…å®®æœè–", w: "â˜€ï¸ æ™´æ™‚å¤šé›²", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=370000",
  i: [
   {tm:"09:00", n:"ç´é›»å‰å¾€ç´å¹³", d:"é«”é©—å¯æ„›çš„é»ƒè‰²é›»è»Šã€‚", 
    tr:{l:"é«˜æ¾ç¯‰æ¸¯ç«™ â†’ ç´å¹³ç«™", f:"ç´„60åˆ†", c:"tag-g", t:"åˆ· ICOCA"},
    o:"Takamatsu-Chikko Station", z:"Kotoden-Kotohira Station", m:"transit",
    tip:{t:"ğŸš‹ ç´é›»æ”»ç•¥", c:"ç›´æ¥åˆ· ICOCA å¡é€²å‡ºç«™å³å¯ï¼Œä¸ç”¨è²·ç¥¨ã€‚æ²¿é€”é¢¨æ™¯å¾ˆç¾ã€‚"}
   },
   {tm:"10:30", n:"é‡‘åˆ€æ¯”ç¾…å®®", d:"æŒ‘æˆ°785éšæ¢¯ï¼Œåƒæ‹œæ—¥æœ¬äººä¸€ç”Ÿå¿…å»çš„ç¥ç¤¾ã€‚", map:"Kotohira-gu"},
   {tm:"13:00", n:"åˆé¤ï¼šç´å¹³è€è¡—", d:"å“åšç¸é¥…é ­æˆ–çƒé¾éºµã€‚", map:"Kotohira Omotesando"},
   {tm:"16:00", n:"èˆŠé‡‘æ¯˜ç¾…å¤§èŠå±…", d:"(é¸) æ—¥æœ¬æœ€å¤è€çš„æ­Œèˆä¼åŠ‡å ´ã€‚", map:"Kanamaruza"},
   {tm:"18:30", n:"è¿”å›é«˜æ¾æ™šé¤", d:"å•†åº—è¡—å±…é…’å±‹æˆ–å®šé£Ÿã€‚", map:"Takamatsu Station"},
   {tm:"20:00", n:"çºŒä½ï¼šæ±æ©«INN é«˜æ¾å…µåº«ç”º", d:"", map:"Toyoko Inn Takamatsu Hyogomachi"}
  ]
 },
 {
  d: "1/7 (ä¸‰)", t: "ç§»å‹•è‡³æ¾å±±ï¼é“å¾Œæº«æ³‰", w: "ğŸŒ¥ï¸ å¤šé›²", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=380000",
  i: [
   {tm:"09:00", n:"JR ç‰¹æ€¥ Ishizuchi", d:"é—œéµé•·é€”ç§»å‹• (é«˜æ¾â†’æ¾å±±)ã€‚", 
    tr:{l:"JRé«˜æ¾ç«™ â†’ JRæ¾å±±ç«™", f:"ç´„2.5å°æ™‚", c:"tag-r", t:"å»ºè­°æŒ‡å®šå¸­"},
    o:"Takamatsu Station", z:"Matsuyama Station", m:"transit",
    tip:{t:"ğŸš„ JR æ­ä¹˜æ³¨æ„", c:"é€™æ®µè·¯ç¨‹è¼ƒé•·ï¼Œä¸”è‡ªç”±å¸­å¯èƒ½æ²’ä½å­æ”¾è¡Œæã€‚å»ºè­° Day 1 æŠµé”æ™‚å°±å…ˆåœ¨ç¶ è‰²çª—å£è²·å¥½é€™è¶Ÿçš„ã€ŒæŒ‡å®šå¸­ã€è»Šç¥¨ã€‚"}
   },
   {tm:"12:00", n:"æŠµé”æ¾å±± & æ”¾è¡Œæ", d:"æ­è·¯é¢é›»è»Šå»é£¯åº—ã€‚", 
    tr:{l:"JRæ¾å±±é§…å‰ â†’ å‹å±±ç”º", f:"è·¯é¢é›»è»Š #5", c:"tag-o", t:"Â¥200 (ç¾é‡‘)"},
    o:"JR Matsuyama Station", z:"Toyoko Inn Matsuyama Ichibancho", m:"transit",
    tip:{t:"ğŸš‹ æ¾å±±è·¯é¢é›»è»Š", c:"1. å‡º JR ç«™ç›´èµ°ï¼Œé›»è»Šç«™åœ¨é¦¬è·¯ä¸­é–“ã€‚<br>2. æ­ã€5è™Ÿç·šã€‘(å¾€é“å¾Œæº«æ³‰)ã€‚<br>3. åœ¨ã€å‹å±±ç”ºã€‘ä¸‹è»Š (ä¸æ˜¯å¤§è¡—é“)ï¼Œéé¦¬è·¯å°±æ˜¯æ±æ©«INNã€‚<br>4. æº–å‚™é›¶éŒ¢ Â¥200 (ICOCAä¸å¯ç”¨)ã€‚"}
   },
   {tm:"13:30", n:"é“å¾Œæº«æ³‰", d:"ç¥éš±å°‘å¥³å ´æ™¯ã€æº«æ³‰å•†åº—è¡—ã€å°‘çˆºæ©Ÿé—œé˜ã€‚", map:"Dogo Onsen Honkan"},
   {tm:"18:00", n:"æ™šé¤ï¼šé¯›é­šé£¯ (é¯›ã‚ã—)", d:"å¿…åƒï¼æ¨è–¦ã€Œä¸¸æ°´ã€æˆ–ã€Œç§‹å˜‰ã€ã€‚", map:"Gansui Dogo"},
   {tm:"20:00", n:"å…¥ä½ï¼šæ±æ©«INN æ¾å±±ä¸€ç•ªç”º", d:"å°±åœ¨å¤§è¡—é“å•†åº—è¡—å°¾ç«¯é™„è¿‘ã€‚", map:"Toyoko Inn Matsuyama Ichibancho"}
  ]
 },
 {
  d: "1/8 (å››)", t: "æ¾å±±åŸï¼æ›é£¯åº—", w: "â˜€ï¸ æ™´æœ—", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=380000",
  i: [
   {tm:"10:00", n:"ç§»å‹•è‡³ REF é£¯åº—", d:"å…ˆå»æ–°é£¯åº—å¯„æ”¾è¡Œæã€‚", 
    tr:{l:"å‹å±±ç”º â†’ æ¾å±±å¸‚é§…", f:"é›»è»Š #3", c:"tag-g", t:"è¡Œæå¯„æ”¾"},
    o:"Toyoko Inn Matsuyama Ichibancho", z:"REF Matsuyama City Station by VESSEL HOTELS", m:"transit",
    tip:{t:"ğŸ¨ é£¯åº—ç§»å‹•", c:"1. é£¯åº—å°é¢æ­é›»è»Šã€3è™Ÿç·šã€‘å¾€ã€Œæ¾å±±å¸‚é§…ã€ã€‚<br>2. çµ‚é»ç«™ä¸‹è»Šï¼ŒREF é£¯åº—å°±åœ¨æ—é‚Š (é«˜å³¶å±‹æ—)ã€‚"}
   },
   {tm:"11:00", n:"æ¾å±±åŸ", d:"æ­ä¹˜å–®äººåŠæ¤…ç©ºä¸­æ•£æ­¥ï¼Œç™»å¤©å®ˆé–£ã€‚", map:"Matsuyama Castle Ropeway Station"},
   {tm:"13:00", n:"åˆé¤ï¼šå¤§è¡—é“å‘¨é‚Š", d:"å•†åº—è¡—è¦“é£Ÿã€‚", map:"Okaido Shopping Street"},
   {tm:"15:00", n:"æ¾å±±å¸‚å€æ·±åº¦éŠ", d:"å‚ä¸Šä¹‹é›²åšç‰©é¤¨ æˆ– å¤§æ‘©å¤©è¼ª (Kururin)ã€‚", map:"Iyotetsu Takashimaya"},
   {tm:"18:30", n:"ç”Ÿæ—¥æ™šé¤ ğŸ‰", d:"æ¾å±±å¸‚ç«™/é«˜å³¶å±‹å‘¨é‚Šç²¾ç·»æ–™ç†ã€‚", map:"Matsuyamashi Station"},
   {tm:"20:00", n:"å…¥ä½ï¼šREF æ¾å±±å¸‚ç«™", d:"äº«å—å¤§æµ´å ´ & æ¡‘æ‹¿ã€‚", map:"REF Matsuyama City Station by VESSEL HOTELS"}
  ]
 },
 {
  d: "1/9 (äº”)", t: "å²¡å±±è¿”ç¨‹ (ç”Ÿæ—¥å¿«æ¨‚)", w: "â˜ï¸ å¤šé›²", wl: "https://www.jma.go.jp/bosai/forecast/#area_type=offices&area_code=330000",
  i: [
   {tm:"09:30", n:"å‰å¾€ JR æ¾å±±ç«™", d:"é ç•™æ™‚é–“ç§»å‹•ã€‚", 
    tr:{l:"æ¾å±±å¸‚é§… â†’ JRæ¾å±±ç«™", f:"é›»è»Š/è¨ˆç¨‹è»Š", c:"tag-r", t:"å‹¿é²åˆ°"},
    o:"Matsuyamashi Station", z:"JR Matsuyama Station", m:"transit",
    tip:{t:"âš ï¸ é—œéµç§»å‹•", c:"å› ç‚ºæ˜¯ç”Ÿæ—¥ä¸”æœ‰è¡Œæï¼Œå»ºè­°ç›´æ¥è«‹é£¯åº—å«è¨ˆç¨‹è»Š (ç´„Â¥1200) ç›´é” JR ç«™ï¼Œè¼•é¬†åˆæº–æ™‚ã€‚è‹¥æ­é›»è»Šè«‹æ­ã€5è™Ÿç·šã€‘ã€‚"}
   },
   {tm:"10:21", n:"ç‰¹æ€¥ Shiokaze 14è™Ÿ", d:"å‰å¾€å²¡å±± (æŒ‡å®šå¸­)ã€‚", 
    tr:{l:"JRæ¾å±± 10:21ç™¼", f:"13:11 æŠµé”å²¡å±±", c:"tag-r", t:"çµ•å°è¦æ­ä¸Š"},
    o:"Matsuyama Station", z:"Okayama Station", m:"transit",
    tip:{t:"ğŸš„ å›ç¨‹ JR", c:"é€™ç­è»Š 13:11 åˆ°å²¡å±±ï¼Œè®“ä½ æœ‰å……è£•æ™‚é–“è²·ä¼´æ‰‹ç¦®ã€‚éŒ¯éé€™ç­æœƒéå¸¸è¶•ï¼"}
   },
   {tm:"13:11", n:"å²¡å±±ç«™åˆé¤ & è³¼ç‰©", d:"é»ƒé‡‘ 1.5 å°æ™‚ï¼šè²·å‰å‚™ç³°å­ã€ç™½æ¡ƒæœå‡ã€‚", map:"Sun Station Okayama"},
   {tm:"14:50", n:"æ©Ÿå ´åˆ©æœ¨æ´¥å·´å£«", d:"å‰å¾€å²¡å±±æ©Ÿå ´ã€‚", 
    tr:{l:"è¥¿å£ 21è™Ÿæœˆå°", f:"14:50ç™¼è»Š", c:"tag-r", t:"é—œéµå·´å£«"},
    o:"Okayama Station", z:"Okayama Airport", m:"transit",
    tip:{t:"ğŸšŒ å·´å£«ä¹˜è»Šè™•", c:"1. å²¡å±±ç«™æ”¹æœ­å£å‡ºä¾†èµ°ã€Œè¥¿å£ã€ã€‚<br>2. ä¸‹é›»æ‰¶æ¢¯åˆ°ä¸€æ¨“å·´å£«ç¸½ç«™ã€‚<br>3. æ‰¾ã€Œ21è™Ÿã€ç«™ç‰Œ (æœ‰å”®ç¥¨æ©Ÿ)ã€‚<br>4. å‹™å¿…æ­ä¸Š 14:50 é€™ç­ï¼Œ15:20 åˆ°æ©Ÿå ´ã€‚"}
   },
   {tm:"15:55", n:"è™èˆªå ±åˆ° (IT263)", d:"è¾¦ç†ç™»æ©Ÿï¼Œ17:55 èµ·é£›ã€‚", map:"Okayama Airport"}
  ]
 }
];

// --- æ¸²æŸ“å¼•æ“ (ä¸è®Š) ---
function render() {
 let h = "";
 D.forEach((d, i) => {
  let list = "";
  d.i.forEach((x, xi) => {
   let tr = "";
   if(x.tr) tr = `<div class="trans"><div class="trans-row"><div class="trans-icon">ğŸ“</div><div>${x.tr.l}</div></div><div class="trans-row"><div class="trans-icon">ğŸ’¡</div><div>${x.tr.f} <span class="tag ${x.tr.c}">${x.tr.t}</span></div></div></div>`;
   
   let b = "";
   if(x.tip) b += `<button class="btn btn-tip" onclick="pop(${i},${xi})">ğŸ’¡ ${x.tip.t}</button>`;
   
   if(x.o && x.z) {
     let url = `https://www.google.com/maps/dir/?api=1&origin=${encodeURIComponent(x.o)}&destination=${encodeURIComponent(x.z)}&travelmode=${x.m}`;
     b += `<div class="btns"><a href="${url}" target="_blank" class="btn btn-map">ğŸ—ºï¸ å°èˆª</a></div>`;
   } else if(x.map) {
     let url = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(x.map)}`;
     b += `<div class="btns"><a href="${url}" target="_blank" class="btn btn-map">ğŸ“ åœ°åœ–</a></div>`;
   }

   list += `<div class="item"><span class="time">${x.tm}</span><div class="name">${x.n}</div>${tr}<div class="desc">${x.d}</div>${b}</div>`;
  });
  
  let disp = i === 0 ? "block" : "none";
  let arr = i === 0 ? "â–²" : "â–¼";
  h += `<div class="card"><div class="card-head" onclick="tog(this)"><div><span class="date-badge">${d.d.split(" ")[0]}</span> <b>${d.t}</b></div><a href="${d.wl}" target="_blank" class="weather">${d.w}</a></div><div class="list" style="display:${disp}">${list}</div></div>`;
 });
 document.getElementById("trip").innerHTML = h;
 loadM();
}

// --- åŠŸèƒ½å‡½æ•¸ ---
function pg(id, el) {
 document.querySelectorAll(".page").forEach(x => x.style.display = "none");
 document.querySelectorAll(".nav-btn").forEach(x => x.classList.remove("active"));
 document.getElementById(id).style.display = "block";
 el.classList.add("active");
 document.body.scrollTop = 0; document.documentElement.scrollTop = 0;
}

function tog(el) {
 let list = el.nextElementSibling;
 let isHidden = list.style.display === "none";
 document.querySelectorAll(".list").forEach(x => x.style.display = "none"); // Accordion style
 list.style.display = isHidden ? "block" : "none";
}

function pop(di, xi) {
 let t = D[di].i[xi].tip;
 document.getElementById("mt").innerText = t.t;
 document.getElementById("mc").innerHTML = t.c;
 document.getElementById("mod").style.display = "flex";
}
function cl(e) { if(e.target.id == "mod") e.target.style.display = "none"; }

// --- è¨˜å¸³åŠŸèƒ½ ---
let M = [];
function loadM() {
 try { M = JSON.parse(localStorage.getItem("m_trip_2026")) || []; } catch { M = []; }
 drawM();
}
function drawM() {
 let h = "", t = 0;
 M.slice().reverse().forEach(x => {
  t += parseInt(x.a);
  h += `<div class="hist-item"><div><b style="font-size:1rem">${x.n}</b> <div style="font-size:0.8rem;color:#888;margin-top:2px">${x.d}</div></div><div style="display:flex;align-items:center"><span style="font-weight:bold;margin-right:10px">Â¥${x.a}</span><button onclick="del(${x.id})" style="border:none;background:#EEE;color:#888;width:24px;height:24px;border-radius:12px;font-weight:bold">Ã—</button></div></div>`;
 });
 document.getElementById("hist").innerHTML = h ? h : "<div style='text-align:center;color:#BBB;padding:20px'>å°šç„¡ç´€éŒ„</div>";
 document.getElementById("t-jpy").innerText = "Â¥" + t.toLocaleString();
 document.getElementById("t-for").innerText = `HK$${Math.round(t * 0.051).toLocaleString()} / NT$${Math.round(t * 0.215).toLocaleString()}`;
}
function add() {
 let d = document.getElementById("dt").value, n = document.getElementById("nm").value, a = document.getElementById("am").value;
 if(!n || !a) { alert("è«‹è¼¸å…¥é …ç›®å’Œé‡‘é¡"); return; }
 M.push({ id: Date.now(), d: d, n: n, a: a });
 localStorage.setItem("m_trip_2026", JSON.stringify(M));
 document.getElementById("nm").value = ""; document.getElementById("am").value = "";
 drawM();
}
function del(id) {
 if(confirm("ç¢ºå®šåˆªé™¤æ­¤ç­†ç´€éŒ„ï¼Ÿ")) { M = M.filter(x => x.id != id); localStorage.setItem("m_trip_2026", JSON.stringify(M)); drawM(); }
}

render();
</script>
</body>
</html> 
